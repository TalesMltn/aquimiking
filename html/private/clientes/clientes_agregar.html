<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Agregar Cliente - TecMerch</title>
  <link rel="stylesheet" href="../../../style/private/clientes/clientes_agregar.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <style>
    form {
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-width: 500px;
      margin-top: 20px;
    }

    label {
      font-weight: 600;
      color: #2c3e50;
    }

    input {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 0.95rem;
      width: 100%;
    }

    .botones {
      display: flex;
      justify-content: flex-start;
      gap: 12px;
      margin-top: 18px;
    }

    .btn-guardar {
      background: #27ae60;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 3px 8px rgba(39, 174, 96, 0.3);
      transition: all 0.2s ease;
    }
    .btn-guardar:hover {
      background: #1e8449;
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(39, 174, 96, 0.4);
    }

    .btn-cancelar {
      background: #e74c3c;
      color: white;
      text-decoration: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 3px 8px rgba(231, 76, 60, 0.3);
      transition: all 0.2s ease;
    }
    .btn-cancelar:hover {
      background: #c0392b;
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(231, 76, 60, 0.4);
    }
  </style>
</head>
<body>
  <div class="contenedor">
    <aside class="sidebar">
      <div class="logo"><i class="bi bi-laptop"></i><span>TecMerch</span></div>
      <nav>
        <a href="../ventas/ventas.html"><i class="bi bi-cart"></i> Ventas</a>
        <a href="../productos/productos.html"><i class="bi bi-box-seam"></i> Productos</a>
        <a href="clientes.html" class="activo"><i class="bi bi-people"></i> Clientes</a>
        <a href="../categorias/categorias.html"><i class="bi bi-tags"></i> Categorías</a>
        <a href="../reportes.html"><i class="bi bi-file-earmark-bar-graph"></i> Reportes</a>
        <a href="../citas_tecnicas/citas_tecnicas.html"><i class="bi bi-tools"></i> Citas Técnicas</a>
      </nav>
    </aside>

    <main class="contenido">
      <h1><i class="bi bi-person-plus"></i> Agregar Cliente</h1>

      <form id="formCliente">
        <label>Nombre:</label>
        <input type="text" id="nombre" placeholder="Ej: Juan Pérez" required>

        <label>DNI:</label>
        <input type="text" id="dni" placeholder="Ej: 74258963" maxlength="8" required>

        <label>Correo electrónico:</label>
        <input type="email" id="email" placeholder="Ej: juanperez@gmail.com" required>

        <label>Teléfono:</label>
        <input type="tel" id="telefono" placeholder="Ej: 987654321" required>

        <label>Dirección:</label>
        <input type="text" id="direccion" placeholder="Ej: Av. Los Olivos 123" required>

        <div class="botones">
          <button type="submit" class="btn-guardar"><i class="bi bi-save"></i> Guardar</button>
          <a href="clientes.html" class="btn-cancelar"><i class="bi bi-x-circle"></i> Cancelar</a>
        </div>
      </form>
    </main>
  </div>

  <script>
    // === Generar ID automático ===
    function generarIdCliente() {
      const clientes = JSON.parse(localStorage.getItem("clientes")) || [];
      const max = clientes.reduce((m, c) => Math.max(m, parseInt(c.id.replace("C", "")) || 0), 0);
      return "C" + String(max + 1).padStart(3, "0");
    }

    // === Guardar Cliente ===
    document.getElementById("formCliente").onsubmit = function(e) {
      e.preventDefault();

      const nombre = document.getElementById("nombre").value.trim();
      const dni = document.getElementById("dni").value.trim();
      const email = document.getElementById("email").value.trim();
      const telefono = document.getElementById("telefono").value.trim();
      const direccion = document.getElementById("direccion").value.trim();

      if (!nombre || !dni || !email || !telefono || !direccion) {
        alert("Completa todos los campos.");
        return;
      }

      const clientes = JSON.parse(localStorage.getItem("clientes")) || [];

      // Verificar si el DNI ya existe
      if (clientes.some(c => c.dni === dni)) {
        alert("El DNI ingresado ya está registrado.");
        return;
      }

      const nuevoCliente = {
        id: generarIdCliente(),
        nombre,
        dni,
        email,
        telefono,
        direccion
      };

      clientes.push(nuevoCliente);
      localStorage.setItem("clientes", JSON.stringify(clientes));

      alert(`Cliente ${nuevoCliente.nombre} registrado correctamente.`);
      window.location.href = "clientes.html";
    };
  </script>
</body>
</html>
