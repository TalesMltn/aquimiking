<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Clientes - TecMerch</title>
  <link rel="stylesheet" href="../../../style/private/clientes/clientes.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>
<body>
  <div class="contenedor">
    <aside class="sidebar">
      <div class="logo">
        <i class="bi bi-laptop"></i>
        <span>TecMerch</span>
      </div>
      <nav>
        <a href="../ventas/ventas.html"><i class="bi bi-cart"></i> Ventas</a>
        <a href="../productos/productos.html"><i class="bi bi-box-seam"></i> Productos</a>
        <a href="clientes.html" class="activo"><i class="bi bi-people"></i> Clientes</a>
        <a href="../categorias/categorias.html"><i class="bi bi-tags"></i> Categorías</a>
        <a href="../reportes.html"><i class="bi bi-file-earmark-bar-graph"></i> Reportes</a>
        <a href="../citas_tecnicas/citas_tecnicas.html"><i class="bi bi-tools"></i> Citas Técnicas</a>
      </nav>
    </aside>

    <main class="contenido">
      <h1><i class="bi bi-people"></i> Clientes</h1>

      <div class="acciones">
        <a href="clientes_agregar.html" class="btn-agregar"><i class="bi bi-person-plus"></i> Agregar Cliente</a>
      </div>

      <table id="tablaClientes">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>DNI</th>
            <th>Correo</th>
            <th>Teléfono</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </main>
  </div>

  <!-- JAVASCRIPT: CARGAR Y ELIMINAR -->
  <script>
    const tbody = document.querySelector('#tablaClientes tbody');
    const LS_KEY = 'clientes';

    // Cargar clientes desde localStorage
    function cargar() {
      return JSON.parse(localStorage.getItem(LS_KEY)) || [];
    }

    // Guardar en localStorage
    function guardar(arr) {
      localStorage.setItem(LS_KEY, JSON.stringify(arr));
    }

    // Renderizar tabla
    function render() {
      const clientes = cargar();
      tbody.innerHTML = '';

      if (clientes.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" style="text-align:center; color:#777;">No hay clientes registrados.</td></tr>';
        return;
      }

      clientes.forEach(c => {
        tbody.innerHTML += `
          <tr>
            <td>${c.id}</td>
            <td>${c.nombre}</td>
            <td>${c.dni}</td>
            <td>${c.correo}</td>
            <td>${c.telefono}</td>
            <td>
              <a href="clientes_editar.html?id=${c.id}" class="btn-editar"><i class="bi bi-pencil"></i></a>
              <button class="btn-eliminar" data-id="${c.id}"><i class="bi bi-trash"></i></button>
            </td>
          </tr>`;
      });

      // Eliminar cliente
      document.querySelectorAll('.btn-eliminar').forEach(btn => {
        btn.onclick = () => {
          const id = btn.dataset.id;
          if (confirm(`¿Eliminar cliente ${id}?`)) {
            guardar(clientes.filter(c => c.id !== id));
            render();
          }
        };
      });
    }

    render();
  </script>
</body>
</html>